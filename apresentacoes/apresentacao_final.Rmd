---
title: "Análise de *codon usage bias* mitocondrial"
output: 
  beamer_presentation:
    fig_width: 10
    fig_height: 7
    theme: "Copenhagen"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, collapse = TRUE)
```

# Introdução

:::::::::::::: {.columns}
::: {.column width="60%"}
- Código genético - Degenerado
- Preferência por códons específicos
  - Viés de uso de codon (*codon usage bias*)
  - Comum no genoma mitocondrial
- Possível explicação
  - Maximizar a transcrição de seus genes (e.g. mais A-T)
- Clado escolhido: Primates
:::
::: {.column width="40%"}
![]("./img/mitogenome.png")
:::
::::::::::::::


# Perguntas

## Perguntas Biológicas

1. Quais aminoácidos apresentam *codon usage bias*?

2. Dentre os que apresentam: Essa preferência está associada ao número de bases AT do códon?
    
::: {.block}
## Perguntas experimentais
1. Há uma diferença entre o número de codons sinônimos usados para cada aa?

2. Há uma diferença entre o número de codons que possuem 1, 2 ou 3 Adeninas ou Timinas?
:::

**Obs**: As perguntas são restritas à mitocôndrias de primatas.


# Estudo observacional

```{r include = FALSE}
#Importando o que vamos precisar
library(tidyverse, warn.conflicts=F, quietly=T)
library(readxl, warn.conflicts=F, quietly=T)
```

\tiny
```{r}
codons <- readxl::read_excel("../primates/Primates_codon_usage.xlsx")  
codons <- codons %>% rename(codon_count = "Number of Codon Occurences")
print.data.frame(head(codons, 2))
```
\normalsize

\vspace{12pt}    

- Não usaremos todas as variáveis medidas
  - **Variáveis Dependentes**:
    - Codon count, Fraction
  - **Variáveis Independentes**:
    - Species, aminoacid, codon

\vspace{12pt}    
    
- Unidade experimental: Espécie
  - Mitogenoma completo da espécie
  - Toda espécie consegue contribuir com um ponto por grupo - Critério de pareamento

# Tamanho da amostra e poder estatístico

\tiny

- Número de espécies
```{r}
length(unique(codons$Species))
```

- Curva de poder estatístico



\normalsize

# Resultados do experimento:

O que fazer aqui? Talvez plotar os gráficos?

\tiny

```{r}
#Visualizando os pontos para os aa_dicodonicos (Fraction)
ggplot(codons %>% filter(Aminoacid != "End")) +
  aes(x = Codon, y = Fraction) + 
  geom_boxplot() +
  geom_point(size=2, alpha = 0.2, position = position_jitter(width = 0.2)) +
  facet_wrap(~Aminoacid, scales = "free")
```
\normalsize

# Teste estatístico:

- Variáveis qualitativas (aa e codons)
- Lidando com porcentagens observadas e esperadas
- Teste para cada aminoácido

- Qui-quadrado de aderência
  - Feito para cada aminoácido
  - Uma variável 
  
-


# Resultados dos testes:
\tiny
```{r}
all_aa = codons %>%
group_by(Aminoacid, Codon) %>%
summarise(sum_codon = sum(codon_count))

for (aa in unique(all_aa$Aminoacid)) {
  subset = all_aa %>% filter(Aminoacid == aa)
  rows = nrow(subset)
  chi_sqr = chisq.test(subset$sum_codon, p = rep(1/rows, rows))
  print(paste("Valor de p para aminoacido", aa, ":", chi_sqr$p.value))
}
```
\normalsize

# O que os resultados significam mesmo?

- Dado que a hipótese nula é verdadeira, a probabilidade de obter um resultado onde a diferença entre valores observados e esperados é igual ou maior que os que eu encontrei é muito baixa (até demais).

- Logo, seria razoável rejeitar a hipótese nula

# Será que os resultados fazem sentido?


# *Pitch* - Biologia Computacional e Reprodutibilidade

![]("./img/big_data.png")

![]("./img/big_data2.png")

# *Pitch* - Biologia Computacional e Reprodutibilidade

- "We used a custom python/perl script to..."
- "An In-house script was used to..."
- "The 199 mitogenomes were downloaded from NCBI. The complete coding sequence was extracted and codon occurrences were counted for each species."

- Daí você procura o código e ele não está em local algum... 

- Você pode contactar o autor do paper e pedir pelo script/jupyter notebook/rmarkdown...
  - Processo demorado: Mais rápido vc mesmo escrever seu programa
  - E isso é péssimo em termos de reprodutibilidade...

- E mesmo que o código esteja disponível, isso ainda não garante que o trabalho seja replicável...
  
# *Pitch* - Biologia Computacional e Reprodutibilidade

- E se focássemos nesses artefatos de pesquisa? 

1. Selecionar uma amostra de papers que manipulem dados usando linguagens de programação
  - Palavras-chave: **"custom script/program"**, **"jupyter notebook/.ipynb"**, **"Rmarkdown/.Rmd"**, etc...
  
2. Se por acaso o código não estiver disponível em lugar nenhum, contactar os autores e requisitar o código...
  
3. Tentar reproduzir as análises computacionais.
  
  
# Não é uma idéia totalmente original...

![]("./img/computational_reproducibility.png")

![]("./img/computational_reproducibility2.png")
